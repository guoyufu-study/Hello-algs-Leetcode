<script src="https://cdn.bootcss.com/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

## 0828. 统计子串中的独特字符

### 问题描述

我们定义了一个函数 `countUniqueChars(s)` 来统计字符串 s 中的独特字符，并返回独特字符的个数。

例如：`s = "LEETCODE"` ，则其中 `"L", "T","C","O","D"` 都是独特字符，因为它们只出现一次，所以 `countUniqueChars(s) = 5` 。

本题将会给你一个字符串 s ，我们需要返回 `countUniqueChars(t)` 的总和，其中 t 是 s 的子字符串。注意，某些子字符串可能是重复的，但你统计时也必须算上这些重复的子字符串（也就是说，你必须统计 s 的所有子字符串中的独特字符）。

由于答案可能非常大，请将结果 \\(\mod 10 ^ 9 + 7\\) 后再返回。


示例 1：

```
输入: "ABC"
输出: 10
解释: 所有可能的子串为："A","B","C","AB","BC" 和 "ABC"。
     其中，每一个子串都由独特字符构成。
     所以其长度总和为：1 + 1 + 1 + 2 + 2 + 3 = 10
```

示例 2：

```
输入: "ABA"
输出: 8
解释: 除了 countUniqueChars("ABA") = 1 之外，其余与示例 1 相同。
```

示例 3：

```
输入：s = "LEETCODE"
输出：92
```

提示：

* \\(0 \leq s.length \leq 10^4\\)
* \\(s 只包含大写英文字符\\)

来源：力扣（LeetCode）
链接：https://leetcode-cn.com/problems/count-unique-characters-of-all-substrings-of-a-given-string
著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。

### 模板代码

``` java
class Solution {
    public int uniqueLetterString(String s) {

    }
}
```

### 解决方案

#### 1. 动态规划

[官方答案](qu0828/solu1/Solution.java)

[动态规划](qu0828/solu2/Solution.java)

##### 思路

我们的需求是：统计字符串的**所有子串**中**独特字符**的个数。我们将字符串记为 \\(S\\)，将答案记为 \\(\mathrm{F}(S)\\)。

我们知道，对于一个字符串 \\(S'\\) 和某一指定的字符 \\(c\\)，要么 \\(c\\) 是字符串 \\(S'\\) 中的独特字符，要么 \\(c\\) 不是字符串 \\(S'\\) 中的独特字符，只有这两种情况。我们用 \\(\mathrm{U}_{c}(S)\\)，标记字符 \\(c\\) 是否是字符串 \\(S'\\) 中的独特字符。
  $$
  \mathrm{U}_{c}(S') =  
  \begin{cases}
  1,  & 是独特字符 \\\\
  0,  & 不是独特字符
  \end{cases}
  $$

要求解 \\(\mathrm{F}(S)\\)，我们只需要解决其子问题：统计字符串 \\(S\\) 的**所有子串**中**某一指定字符c是独特字符**的子串的个数就可以了。我们将其记为 \\(\mathrm{F}_{c}\\)，其中 \\(c \in \mathcal{A}\\)，\\(\mathcal{A}\\) 为大写字母表。
那么，我们有 \\(\mathrm{F}(S) = \sum_{c \in \mathcal{A}} \mathrm{F}_{c}\\)。

要求解 \\(\mathrm{F}_{c}\\)，我们可以先解决其子问题：统计字符串 \\(S\\) 的**以 \\(S[i]\\) 字符开始的所有子串**中**字符 \\(c\\) 是独特字符**的子串的个数。我们将其记为 \\(\mathrm{F}_{c}(i)\\)。
那么，我们有 \\(\mathrm{F}_{c} = \sum_{i=0}^{S.length()} \mathrm{F}_{c}(i)\\)，同样， \\(c \in \mathcal{A}\\)，\\(\mathcal{A}\\) 为大写字母表。

要求解 \\(\mathrm{F}_{c}(i)\\)，只需要知道 \\(S[i]\\) 字符之后，第1个和第2个 \\(c\\) 字符的索引即可。我们将这个两个索引分别记为 \\(p\\) 和 \\(q\\)。 那么，我们有 \\(\mathrm{F}_{c}(i) = q - p\\)。

我们用列表 \\(index_{c}\\) 按递增序存储字符串 \\(S\\) 中字符 \\(c\\) 的位置索引。结合上两段，我们有 
$$\begin{aligned}
   \mathrm{F}_{c} 
   & = \sum_{i=0}^{S.length()} \mathrm{F}_{c}(i) \\\\
   & = \sum_{i=0}^{S.length()} index_{c}[j+1] - index_{c}[j]，其中 \min_{index_{c}[j] \geq i}(index_{c}) 
   \end{aligned}$$
      
综上，我们有

$$
\begin{aligned}
\mathrm{F}(S)
& = \mathrm{F}_{c \in \mathcal{A}} = \sum_{c \in \mathcal{A}} \mathrm{F}_{c}, & 其中 \mathcal{A} 为大写字母表 \\\\
& = \sum_{c \in \mathcal{A}} \sum_{i=0}^{S.length()} \mathrm{F}_{c}(i) \\\\
& = \sum_{c \in \mathcal{A}} \sum_{i=0}^{S.length()} index_{c}[j+1] - index_{c}[j], & 其中 \min_{index_{c}[j] \geq i}(index_{c})
\end{aligned}
$$


##### 思路一（推荐）


1. 在字符串\\(S\\)中，字符\\('A'\\)是否是独特字符？

   用\\(\mathrm{U}_{A}(S)\\)，表示在字符串\\(S\\)中，字符\\('A'\\)是否是独特字符。要么\\('A'\\)是独特字符，值为1，要么\\('A'\\)不是独特字符，值为0； 
  $$
  \mathrm{U}_{A}(S) =  
  \begin{cases}
  1,  & 是独特字符 \\\\
  0,  & 不是独特字符
  \end{cases}
  $$

2. 字符串\\(S\\)中，以\\(S[i]\\)字符开始的所有子串中，字符\\('A'\\)是独特字符的子串的个数？

   用\\(\mathrm{F}_{'A'}(i)\\)，表示字符串\\(S\\)中，以\\(S[i]\\)字符开始的所有子串中，字符\\('A'\\)是独特字符的子串的个数。
   
   用\\(index_{A}[j]\\)，表示字符串\\(S\\)中字符\\('A'\\)的位置索引。而且，这些索引在数组\\(index_{A}\\)中递增存储。
      
   那么，我们有
  $$
  \mathrm{F}_{A}(i) = index_{A}[j+1] - index_{A}[j]，其中 \min_{index_{A}[j] \geq i}(index_{A})
  $$
  
3. 字符串\\(S\\)，所有子字符串中，字符\\('A'\\)是独特字符的子串的个数？

   \\(\mathrm{F}_{A}\\)，表示字符串\\(S\\)中，所有子串中，字符\\('A'\\)是独特字符的子串数量。

   那么，我们有
   $$\begin{aligned}
   \mathrm{F}_{A} 
   & = \sum_{i=0}^{S.length()} \mathrm{F}_{A}(i) \\\\
   & = \sum_{i=0}^{S.length()} index_{A}[j+1] - index_{A}[j]，其中 \min_{index_{A}[j] \geq i}(index_{A}) 
   \end{aligned}$$
   
4. 字符串\\(S\\)，所有子字符串中，独特字符的个数？

   \\(\mathrm{F}(S)\\)，表示字符串\\(S\\)中，所有子字符串中，独特字符的个数。
   
   那么，我们有
   $$\begin{aligned}
   \mathrm{F}_{c \in \mathcal{A}} 
   & = \sum_{c \in \mathcal{A}} \mathrm{F}_{c}, & 其中 \mathcal{A} 为字母表 \\\\
   & = \sum_{c \in \mathcal{A}} \sum_{i=0}^{S.length()} \mathrm{F}_{c}(i) \\\\
   & = \sum_{c \in \mathcal{A}} \sum_{i=0}^{S.length()} index_{c}[j+1] - index_{c}[j], & 其中 \min_{index_{c}[j] \geq i}(index_{c})
   \end{aligned}$$


##### 思路二

1. 在字符串 \\(S\\) 中，字符 \\('A'\\) 是否是独特字符？

   用 \\(\mathrm{U}_{A}(S)\\)，表示在字符串 \\(S\\) 中，字符 \\('A'\\) 是否是独特字符。要么 \\('A'\\) 是独特字符，值为1，要么 \\('A'\\) 不是独特字符，值为0； 
  $$
  \mathrm{U}_{A}(S) =  
  \begin{cases}
  1,  & 是独特字符 \\\\
  0,  & 不是独特字符
  \end{cases}
  $$

2. 字符串 \\(S\\) 中，所有独特字符的个数？

   用 \\(\mathrm{U}(S)\\)，表示字符串 \\(S\\) 中独特字符的个数。

   那么，我们有 
  $$
  \mathrm{U}_{c \in \cal{A}}(S) = \sum_{c \in \cal{A}}\mathrm{U}_{c}(S)，其中 \cal{A} 为字母表。
  $$
  
3. 字符串 \\(S\\) 中，以 \\(S[i]\\) 字符开始的所有子串中，独特字符的个数？

   用 \\(\mathrm{F}(i)\\)，表示字符串 \\(S\\) 中，以 \\(S[i]\\) 字符开始的所有子串中，独特字符的个数。
   
   用 \\(index_{c}[j]\\)，表示字符串 \\(S\\) 中字符 \\(c\\) 的位置索引，其中 \\(c \in \cal{A}\\)，而 \\(\cal{A}\\) 为字母表。而且，这些索引在数组 \\(index_{c}\\) 中递增存储。比如，\\(index_{A}[j]\\)，表示字符串 \\(S\\) 中字符 \\('A'\\) 的位置索引。
   
   那么，我们有
   $$\begin{align}
   \mathrm{F}_{c \in \cal{A}}(i) 
   & = \sum_{c \in \cal{A}} \mathrm{F}_{c}(i)，& 其中  \cal{A} 为字母表。 \\\\
   & =  \sum_{c \in \cal{A}} index_{c}[j+1] - index_{c}[j]， & 其中 \min_{index_{A}[j] \geq i}(index_{A})。
   \end{align}$$

4. 字符串 \\(S\\) 中，所有子字符串中，独特字符的个数？

   用 \\(\mathrm{F}(S)\\)，表示字符串 \\(S\\) 中，所有子字符串中，独特字符的个数。
   
   那么，我们有
   $$\begin{align}
   \mathrm{F}_{c \in \cal{A}}(S)
   & = \sum_{i=0}^{S.length()} \mathrm{F}_{c \in \cal{A}}(i), & 其中  \cal{A} 为字母表 \\\\
   & = \sum_{i=0}^{S.length()} \sum_{c \in \cal{A}}\mathrm{F}_{c}(i), & \\\\
   & = \sum_{i=0}^{S.length()} \sum_{c \in \cal{A}} index_{c}[j+1] - index_{c}[j], & 其中 \min_{index_{A}[j] \geq i}(index_{A})。
   \end{align}$$
   
